<!DOCTYPE html>
<html lang="es">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>¬°Atrapa las Estrellas! - PEMSAM</title>
  <style>
    :root {
      --azul: #03658C;
      --amarillo: #F2B705;
      --rosa: #FF69B4;
      --verde: #4CAF50;
      --morado: #9C27B0;
      --gris: #f0f0f0;
    }

    * {
      box-sizing: border-box;
      margin: 0;
      padding: 0;
    }

    body {
      margin: 0;
      font-family: 'Comic Sans MS', cursive, sans-serif;
      background: linear-gradient(135deg, #a8edea 0%, #dfe9f3 100%);
      color: #333;
      min-height: 100vh;
      display: flex;
      justify-content: center;
      align-items: center;
    }

    .wrap {
      max-width: 900px;
      margin: 20px auto;
      padding: 20px;
    }

    .panel {
      background: white;
      border: 4px solid var(--azul);
      border-radius: 20px;
      padding: 20px;
      box-shadow: 0 15px 35px rgba(0,0,0,0.15), 
                  0 0 0 5px #fff, 
                  0 0 20px rgba(255, 105, 180, 0.3);
      text-align: center;
      animation: float 3s ease-in-out infinite alternate;
    }

    @keyframes float {
      0% { transform: translateY(0px); }
      100% { transform: translateY(-10px); }
    }

    h1 {
      margin: 0 0 15px;
      font-size: 2rem;
      color: var(--morado);
      text-shadow: 2px 2px 4px rgba(0,0,0,0.1);
      letter-spacing: 1px;
    }

    .scoreboard {
      font-weight: 700;
      font-size: 1.2rem;
      color: #024;
      margin-bottom: 15px;
    }

    #game {
      width: 400px;
      height: 300px;
      margin: 20px auto;
      border: 4px solid var(--amarillo);
      border-radius: 15px;
      overflow: hidden;
      background: #fff9e6;
      position: relative;
      cursor: pointer;
      box-shadow: 0 10px 20px rgba(0,0,0,0.1);
    }

    .target {
      position: absolute;
      border-radius: 50%;
      background: radial-gradient(circle at 30% 30%, #fff, var(--rosa));
      box-shadow: 0 4px 10px rgba(0,0,0,0.2), 
                  inset 0 0 20px rgba(255,255,255,0.5);
      cursor: pointer;
      transform-origin: center;
      display: flex;
      align-items: center;
      justify-content: center;
      font-size: 1.5em;
    }

    .target::after {
      content: "‚≠ê";
      pointer-events: none;
    }

    .explosion {
      position: absolute;
      font-size: 2em;
      animation: explode 0.6s forwards;
      opacity: 0;
      z-index: 10;
      pointer-events: none;
    }

    @keyframes explode {
      0% { transform: scale(0.5); opacity: 0.8; }
      100% { transform: scale(1.5); opacity: 0; }
    }

    .controls {
      display: flex;
      flex-direction: column;
      gap: 10px;
      align-items: center;
      margin: 15px 0;
    }

    .btn {
      background: var(--verde);
      color: white;
      border: 0;
      padding: 12px 20px;
      border-radius: 25px;
      cursor: pointer;
      font-weight: 700;
      font-size: 1.1rem;
      box-shadow: 0 4px 8px rgba(0,0,0,0.2);
      transition: all 0.3s;
    }

    .btn:hover {
      background: var(--amarillo);
      color: var(--azul);
      transform: scale(1.05);
    }

    .btn:active {
      transform: scale(0.98);
    }

    .msg {
      font-weight: 700;
      font-size: 1.2rem;
      color: var(--azul);
      margin-top: 10px;
      min-height: 30px;
      height: 30px;
      line-height: 30px;
    }

    .celebration {
      font-size: 1.5rem;
      color: var(--verde);
      animation: bounce 0.6s ease infinite alternate;
    }

    @keyframes bounce {
      from { transform: translateY(0); }
      to { transform: translateY(-8px); }
    }
  </style>
</head>
<body>
  <div class="wrap">
    <div class="panel">
      <h1>¬°Atrapa las Estrellas! üåü</h1>
      <div class="scoreboard">Puntos: <span id="score">0</span> | Tiempo: <span id="time">30</span>s</div>
      <div id="game" aria-label="Juego de atrapar estrellas">
      </div>
      <div class="controls">
        <button id="restart" class="btn">üîÅ Reiniciar</button>
        <p style="font-size:0.9rem; color:#555;">¬°Haz clic antes de que exploten!</p>
      </div>
      <div class="msg" id="msg"></div>
    </div>
  </div>

  <script>
    (function(){
      const game = document.getElementById('game');
      const scoreEl = document.getElementById('score');
      const timeEl = document.getElementById('time');
      const msgEl = document.getElementById('msg');
      const restartBtn = document.getElementById('restart');

      // Sonidos
      const soundHit = new Audio("https://assets.mixkit.co/sfx/preview/mixkit-arcade-retro-jump-223.mp3");
      const soundPop = new Audio("https://assets.mixkit.co/sfx/preview/mixkit-balloon-pop-2560.mp3");
      const soundTimeUp = new Audio("https://assets.mixkit.co/sfx/preview/mixkit-wrong-electric-buzz-955.mp3");
      const soundCheer = new Audio("https://assets.mixkit.co/sfx/preview/mixkit-winning-chimes-2015.mp3");

      let score = 0;
      let timeLeft = 30;
      let spawnId = null, timerId = null;
      let targets = []; // cada objetivo tiene: element, size, growingInterval
      let running = false;

      function clamp(v, min, max) {
        return Math.max(min, Math.min(max, v));
      }

      function createTarget() {
        if (!running) return;

        const t = document.createElement('div');
        t.className = 'target';

        const initialSize = 10; // empieza muy peque√±o
        const maxSize = 60;   // tama√±o m√°ximo antes de explotar
        const growthRate = 0.8; // px por frame (60ms)

        const maxLeft = game.clientWidth - maxSize;
        const maxTop = game.clientHeight - maxSize;
        const left = Math.random() * maxLeft;
        const top = Math.random() * maxTop;

        t.style.width = initialSize + 'px';
        t.style.height = initialSize + 'px';
        t.style.left = left + 'px';
        t.style.top = top + 'px';
        t.style.opacity = '0.8';

        // Color aleatorio
        const colors = ['#FF69B4', '#9C27B0', '#4CAF50', '#FF9800', '#2196F3', '#FFD700'];
        t.style.background = `radial-gradient(circle at 30% 30%, #fff, ${colors[Math.floor(Math.random() * colors.length)]})`;

        game.appendChild(t);

        // Guardar datos del objetivo
        const targetData = {
          element: t,
          currentSize: initialSize,
          growing: setInterval(() => {
            if (!running) return;
            targetData.currentSize += growthRate;
            if (targetData.currentSize >= maxSize) {
              clearInterval(targetData.growing);
              explodeTarget(targetData);
            } else {
              t.style.width = targetData.currentSize + 'px';
              t.style.height = targetData.currentSize + 'px';
            }
          }, 60)
        };

        targets.push(targetData);

        t.addEventListener('click', function(ev) {
          ev.stopPropagation();
          if (!targetData.growing) return; // ya explot√≥

          clearInterval(targetData.growing);
          targets = targets.filter(td => td !== targetData);

          // Efecto de explosi√≥n positiva
          const explosion = document.createElement('div');
          explosion.className = 'explosion';
          explosion.textContent = '‚ú®';
          explosion.style.left = (left + targetData.currentSize/2 - 15) + 'px';
          explosion.style.top = (top + targetData.currentSize/2 - 15) + 'px';
          game.appendChild(explosion);
          setTimeout(() => explosion.remove(), 600);

          // Sonidos y puntuaci√≥n
          soundHit.currentTime = 0;
          soundHit.play();

          score += 1;
          scoreEl.textContent = score;

          // Mensaje positivo
          const compliments = ["¬°Bien hecho!", "¬°Genial!", "¬°S√≠!", "¬°Qu√© r√°pido!", "¬°Eres un campe√≥n!"];
          msgEl.innerHTML = `<span class="celebration">${compliments[Math.floor(Math.random() * compliments.length)]}</span>`;
          setTimeout(() => msgEl.textContent = '', 800);

          t.remove();
        });
      }

      function explodeTarget(targetData) {
        const t = targetData.element;
        targets = targets.filter(td => td !== targetData);

        // Efecto de explosi√≥n negativa
        const explosion = document.createElement('div');
        explosion.className = 'explosion';
        explosion.textContent = 'üí•';
        const left = parseFloat(t.style.left);
        const top = parseFloat(t.style.top);
        explosion.style.left = (left + parseFloat(t.style.width)/2 - 15) + 'px';
        explosion.style.top = (top + parseFloat(t.style.height)/2 - 15) + 'px';
        game.appendChild(explosion);
        setTimeout(() => explosion.remove(), 600);

        soundPop.currentTime = 0;
        soundPop.play();

        t.remove();
      }

      function stop() {
        running = false;
        if (spawnId) clearInterval(spawnId);
        if (timerId) clearInterval(timerId);

        targets.forEach(targetData => {
          if (targetData.growing) clearInterval(targetData.growing);
        });
        targets = [];

        // Limpiar elementos restantes
        document.querySelectorAll('.target').forEach(el => el.remove());
      }

      function reset() {
        stop();
        score = 0;
        timeLeft = 30;
        scoreEl.textContent = '0';
        timeEl.textContent = '30';
        msgEl.textContent = '';
      }

      function start() {
        reset();
        running = true;
        spawnId = setInterval(createTarget, 1800); // Nueva estrella cada 1.8 segundos
        timerId = setInterval(() => {
          timeLeft--;
          timeEl.textContent = timeLeft;
          if (timeLeft <= 0) {
            stop();
            soundTimeUp.play();
            setTimeout(() => {
              soundCheer.play();
              msgEl.innerHTML = `üéâ ¬°Felicidades! Terminaste con <strong>${score}</strong> puntos! üéâ`;
            }, 500);
          }
        }, 1000);
      }

      restartBtn.addEventListener('click', start);
      window.addEventListener('beforeunload', stop);

      // Iniciar juego
      start();
    })();
  </script>
</body>
</html>
